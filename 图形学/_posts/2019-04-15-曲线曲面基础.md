---
layout:      post
title:       曲线曲面基础
subtitle: 
date:		 2019-04-15
author:		 Haiden
header-img:   
catalog:     true
category:    图形学
tags: 
   - 图形学
---

### 一、曲线曲面基础

#### 1.1 显示、隐式和参数表示

曲线和曲面的表示方程有参数表示和非参数表示之分，非参数表示又分为显式表示和隐式表示。

对于一个平面曲线，显式表示形式：y = f(x)。显式不能表示封闭或多值曲线。

隐式表示形式：f(x，y)= 0 。判断一个点是否在曲线上。

#### 1.2 参数方程

曲线曲面方程通常表示成参数的形式，假定用t表示参数，

平面曲线上任一点P可表示为： p ( t ) = [ x ( t ), y ( t )]

空间曲线上任一三维点P可表示为： p ( t ) = [ x ( t ), y ( t ), z ( t )]

等价于笛卡儿分量表示：p ( t ) = x ( t ) i + y ( t ) j + z ( t ) k

给定一个t值，就得到曲线上一点的坐标

假设曲线段对应的参数区间为[a,b]，即a≤t≤b。为方便期间，可以将区间[a,b]规范化成[0,1]，参数变换为：


$$
t' = \frac{t-a}{b-a}
$$


参数曲线一般写成：$p = p ( t ) \quad  t \in [0 , 1 ]​$ ；

参数曲线是直线段时，端点为P1、P2的直线段参数方程可表示为：$p(t)  = p_{1} +  ( p_{2}- p_{1} )t  \quad
t \in [ 0 ,1]$ 。

#### 1.3 参数方程的优势

**1）可以满足几何不变性的要求**

形状的数学表示及其所表达的形状不随所取坐标系而改变的性质

**2）有更大的自由度来控制曲线、曲面的形状**

二维三次曲线的参数表达式为：


$$
p(t) = 
\begin{bmatrix}
a_{1}t^{3}+a_{2}t^{2}+a_{3}t+a_{4}\\ 
b_{1}t^{3}+b_{2}t^{2}+b_{3}t+b_{4}
\end{bmatrix} \quad t \in (0,1)
$$


有8个系数可用来控制此曲线的形状

3）**直接对参数方程进行几何变换**

对非参数方程表示的曲线、曲面进行变换，必须对曲线、曲面上的每个型值点进行几何变换；而对参数表示的曲线、曲面可对其参数方程直接进行几何变换。

**4）便于处理斜率为无穷大的情形，不会因此而中断计算**

**5）界定曲线、曲面的范围十分简单**

具有规格化的参数变量t∈[0,1]

**6）易于用向量（矢量）和矩阵运算，简化计算**

#### 1.4 参数曲线的基本概念

一条用参数表示的三维曲线是一个有界点集，可写成一个带参数的、连续的、单值的数学函数，其形式：
$$
\begin{cases}
 & x = x(t) \\ 
 & y = y(t) \\ 
 & z = z(t) 
\end{cases} \quad
0 \leqslant  t \leqslant  1
$$

$$
p'(t) = \frac{dP}{dt} \quad \quad  p''(t) = \frac{d^{2}P}{dt^{2}}
$$


**1）位置矢量**

曲线上任一点的位置矢量可表示为：p (t ) = [ x (t ), y (t ), z (t )]

![](http://images.cronusliang.me/graphics/locate_vector.png)

**（2）切矢量**

选择弧长s作为参数，当△t→0时，弦长△s→0，但方向不能趋向于0。

单位矢量    
$$
T = \frac{dP}{ds} = \lim_{ △s→0 } \frac{△P}{△s}
$$


根据弧长微分公式有：$( ds)^{2} =  (dx )^{2} +(dy )^{2}+ (dz )^{2}$

引入参数t，可改写为：
$$
(ds/dt)^{2} = (dx/dt)^{2} + (dy/dt)^{2} +(dz/dt)^{2} = \left |P'(t)  \right | ^{2}
$$


T是单位切矢量
$$
T = \frac{dP}{ds} = \frac{dP}{dt} \cdot \frac{dt}{ds} = \frac{P'(t)}{\left |P'(t)  \right |}
$$


其中*d*/*ds* 是对弧长的微分。

**（3）曲率**

切向量求导，求导以后还是一个向量，称为曲率。曲线的单位切向量对弧长的转动率，即刻画这一点的曲线的弯曲程度。

![](http://images.cronusliang.me/graphics/curvature.png)
$$
k = \left| T' \right| = \lim_{△s→0} \left| \frac{△T}{△s} \right| = \lim_{△s→0} \left| \frac{T(s+△s)-T(s)}{△s} \right| = \lim_{△s→0} \left| \frac{△θ}{△s} \right|
$$


曲率越大，表示曲线的弯曲程度越大。曲率k的倒数  $\rho = \frac{1}{k} $  称为曲率半径。

曲率半径越大，圆弧越平缓；曲率半径越小，圆弧越陡。

**（4）法矢量**

法矢量是与切矢量垂直的向量，T(切矢)、N(主法矢)和B(副法矢)构成了曲线上的活动坐标架。

B = T x N

[弗勒内-塞雷公式](https://zh.wikipedia.org/wiki/%E5%BC%97%E8%8E%B1%E7%BA%B3%E5%85%AC%E5%BC%8F)

![](http://images.cronusliang.me/graphics/normal_vector.png)

**（5）挠率**

空间曲线不但要弯曲，而且还要扭曲，即要离开它的密切平面。为了能刻画这一扭曲程度，等价于去研究密切平面的法矢量（即曲线的副法矢量）关于弧长的变化率。

挠率 τ 的绝对值等于副法线方向(或密切平面)对于弧长的转动率：
$$
\left| τ  \right| = \lim_{△s} \left| \frac{△θ}{△s} \right| 
$$


#### 1.5 插值

给定一组有序的数据点Pi(i=0,1,2,…n), 要求构造一条曲线顺序通过这些数据点，称为对这些数据点进行插值，所构造的曲线称为插值曲线。

**(1) 线性插值：**

假设给定函数f(x)在两个不同点 $x_{1}$ 和 $x_{2}$ 的值，用一个线形函数：y=ax+b，近似代替，称为的线性插值函数。

![](http://images.cronusliang.me/graphics/linear_interpolation.png)

**(2) 抛物线插值**

已知三个点的坐标，要求构造一个抛物线函数。
$$
\varphi (x) = ax^{2}+ bx+ c
$$
![](http://images.cronusliang.me/graphics/parabola_interpolation.png)



#### 1.6 拟合

构造一条曲线使之在某种意义下最接近给定的数据点(但未必通过这些点)，所构造的曲线为拟合曲线。

逼近指用一些性质较好的函数近似表示一些性质不好的函数。插值和拟合都可以视为逼近。

#### 1.7 光顺

指曲线的拐点不能太多（有一、二阶导数等），在数学领域是指：凸曲线与凹曲线的连接点。

![](http://images.cronusliang.me/graphics/inflexion.png)

对平面曲线而言，相对光顺的条件是：

1. 具有二阶几何连续性($G^{2}$)
2. 不存在多余拐点和奇异点
3. 曲率变化较小

#### 1.8 连续性

当许多参数曲线段首尾相连构成一条曲线时，如何保证各曲线段在连接处具有合乎要求的连续性是一个重要问题。假定参数曲线段 pi 以参数形式进行描述：
$$
p_{i} = p_{i}(t) \quad t \in [t_{i0},t_{i1}]
$$


讨论参数曲线两种意义上的连续性：即参数连续性和几何连续性。

**（1）参数连续性**

**0阶参数连续性：**

记作 $C^{0}$ 连续性，是指曲线的几何位置连接，即第一个曲线段在 $t_{i1}$ 处的x,y,z值与第二个曲线段在

 $t_{(i+1)0}$ 处的x,y,z值相等： 

![](http://images.cronusliang.me/graphics/ti1_t%28i+1%29.png)

**1阶参数连续性：**

记作 $C^{1}$ 连续性，指代表两个相邻曲线段的方程在相交点处有相同的一阶导数（切线）：

![](http://images.cronusliang.me/graphics/one_order.png)

**2阶参数连续性：**

记作 $C^{2}$ 连续性，指两个相邻曲线段的方程在相交点处具有相同的一阶和二阶导数。

对于 $C^{2}$ 连续性，交点处的切向量变化率相等，即切线从一个曲线段平滑地变化到另一个曲线段。

![](<http://images.cronusliang.me/graphics/two_order.png)



**（2）几何连续性**

曲线段相连的另一个连续性条件是几何连续性。与参数连续性不同的是，它只需曲线段在相交处的参数导数成比例即可。

**0阶几何连续性：**

记作 $G^{0}$ 连续性。与0阶参数连续性的定义相同，满足：
$$
P_{i}(t_{i1}) = P_{(i+1)}(t_{(i+1)0})
$$


**1阶几何连续性:**

记作 $G^{1}$ 连续性。若要求在结合处达到 $G^{1}$ 连续，就是说两条曲线在结合处在满足 $G^{ 0}$ 连续的条件下，并有公共的切矢 (公共切矢意味着方向相同但大小不等)。
$$
Q'(0) = \alpha P’(1) \quad (\alpha > 0)
$$


**2阶几何连续性:**

记作 $G^{2}$ 连续性。就是说两条曲线在结合处在满足 $G^{1}​$  连续的条件下，并有公共的曲率。



#### 1.9 参数化

插值多项式可以有无数条，这是因为对应地参数t在[0, 1]中可以有无数种取法。

参数方程：
$$
x(t) = a_{1}t^{2} + a_{2}t +a_{3} \\
y(t) = b_{1}t^{2} + b_{2}t + b_{3}
$$


对于一条插值曲线，型值点p0，p1，… ，pn 与其参数域t∈[t0，t1] 内的节点之间有一种对应关系。对于一组有
序的型值点，所确定一种参数分割，称之这组型值点的参数化。

参数化的本质就是找一组恰当的参数t来匹配这一组不同的型值点。参数化常用方法：

**（1）均匀参数化**

节点在参数轴上呈等距分布。如0、1/10、2/10。。。

**（2）累加弦长参数化**

根据长度的比例关系来确定t


$$
\begin{cases}
t_{0} = 0 \\ 
t_{i} = t_{i-1} + \left| △P_{i-1} \right|,i = 1,2,,..,n    \quad △P_{i} = p_{i+1}-P_{i}
\end{cases}
$$


 **(3)  向心参数化法**

向心参数化法假设在一段曲线弧上的向心力与曲线切矢从该弧段始端至末端的转角成正比，加上一些简化假设，得到向心参数化法。


$$
t_{0} = 0 \\ 
t_{i} = t_{i-1} + \left| △P_{i-1} \right|^{1/2},i = 1,2,,..,n
$$


#### 1.10 参数曲线的代数和几何形式

以三次参数曲线为例，讨论参数曲线的代数和几何形式

**(1) 代数形式：**
$$
\begin{cases}
x(t) = a_{3x}t^{3} + a_{2x}t^{2} + a_{1x}t + a_{0x} \\ 
y(t) = a_{3y}t^{3} + a_{2y}t^{2} + a_{1y}t + a_{0y}   \quad \quad t \in[0,1]  \\
z(t) = a_{3z}t^{3} + a_{2z}t^{2} + a_{1z}t + a_{0z} 
\end{cases}
$$


上述代数式写成矢量式是：


$$
P(t) = a_{3}t^{3} + a_{2}t^{2} + a_{1}t + a_{0} \quad t\in[0,1]
$$


a3，a2，a1，a0是参数曲线的系数，但不是常数而是向量。a3对应刚才的a3x、a3y、a3z。

**(2) 几何形式：**

几何形式是利用一条曲线端点的几何性质来刻画一条曲线。所谓端点的几何性质，就是指曲线的端点位置、切向量、各阶导数等端点的信息。

对三次参数曲线，若用其端点位矢P(0)、P(1)和切矢P’(0)、P’(1)描述。需要这四个量来刻画三次参数曲线

将P(0)、P(1)、P’(0)和 P’(1) 简记为：

![](http://images.cronusliang.me/graphics/geometry.png)



![](http://images.cronusliang.me/graphics/hermite.png)



上式是三次Hermite曲线（三次哈密特曲线）的几何形式，

几何系数是：
$$
P_{0}  、P_{1} 、P'_{0} 、P'_{1}
$$


F0、F1、G0、G1称为调和函数（或混合函数）。

![](http://images.cronusliang.me/graphics/hermite_curve.png)

